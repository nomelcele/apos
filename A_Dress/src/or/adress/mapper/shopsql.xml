<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="shop">
	<insert id="shopjoin" parameterType="shvo">
		insert into shop values(
		shop_seq.nextval,#{shop_name},#{shop_tel},#{shop_adr},#{shop_map_x},
		#{shop_map_y},sysdate,#{shop_mail}, #{shop_master},
		#{shop_img},#{shop_crnum},1,#{shop_id},#{shop_pwd})
	</insert>
	<insert id="shoprequesthotkey" parameterType="shotvo">
		insert into hotkey
		values(hotkey_seq.nextVal,#{key_name},#{key_hotkey},#{key_email},#{key_crum},sysdate)
	</insert>

	<select id="getListRequestShop" resultType="shotvo">
		select * from hotkey
	</select>

	<select id="checkhotcrnumname" parameterType="int" resultType="shotvo">
		select * from hotkey where key_crnum=#{crnum}
	</select>

	<select id="checkid" parameterType="String" resultType="shvo">
		select * from shop where shop_id=#{shop_id}
	</select>

	<select id="checkMasteridpwd" parameterType="map" resultType="shvo">
		select * from shop where shop_id=#{id} and shop_pwd=#{pwd}
	</select>

	<select id="checkStaffidpwd" parameterType="map" resultType="shvo">
		select * from Staff where staff_id=#{id} and staff_pwd=#{pwd}
	</select>

	<select id=" getshopno" parameterType="String" resultType="int">
		select shop_num from Shop where shop_id=#{id}
	</select>

	<select id="getshopname" parameterType="string" resultType="shvo">
		select * from shop where shop_id=#{id}
	</select>

	<select id="findid" parameterType="map" resultType="String">
		select shop_id from shop where shop_master=#{name} and shop_tel=#{tel}

	</select>
	<select id="findpwd" parameterType="map" resultType="String">
	select shop_pwd from shop where shop_name=#{shop_name} and shop_id=#{shop_id}
	</select>
	<select id="shopList" parameterType="shvo">
	select *from shop
	</select>

	<select id="memberlist" parameterType="map" resultType="memvo">
		select * from member where mem_name like %#{mem_name}% or mem_tel like %#{mem_tel}%
	</select>
	
	<select id="listproduct" parameterType="map" resultMap="map">
	select p.pro_code, p.pro_name, p.pro_price, s.sto_size, sh.shop_name, s.sto_amount, p.PRO_IMG, p.PRO_BARCODE from product p, stock s, shop sh where p.pro_code = s.sto_pronum and sh.shop_num=sto_shopnum and( p.pro_code like %#{check}% or p.pro_name like %#{check}%) and sh.shop_num = #{shopnum}
	</select>
	
	<insert id="insertMem" parameterType="map">
	insert into member values(member_seq.nextval,#{name},#{tel},#{post},#{adr3},#{adr4},0,sysdate,1,#{email})
	</insert>
	
	<select id="memdetail" parameterType="int" resultType="memvo">
	select * from member where mem_num=#{no}
	</select>
	
	<!-- 물어볼것! -->
	<update id="memupdate" parameterType="map">
	update member set mem_tel=#{memtel},mem_addr=#{addr},mem_deaddr=#{deaddr},mem_mileage=#{mileage} where mem_num=#{num}
	</update>
	
	<delete id="memdelete" parameterType="memvo">
	delete from member where mem_num=#{num}
  	</delete>
	
	
</mapper>
